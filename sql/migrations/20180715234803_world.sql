DROP PROCEDURE IF EXISTS add_migration;
delimiter ??
CREATE PROCEDURE `add_migration`()
BEGIN
DECLARE v INT DEFAULT 1;
SET v = (SELECT COUNT(*) FROM `migrations` WHERE `id`='20180715234803');
IF v=0 THEN
INSERT INTO `migrations` VALUES ('20180715234803');
-- Add your query below.


ALTER TABLE `npc_vendor`
	ADD COLUMN `itemflags` INT(10) UNSIGNED NOT NULL DEFAULT '0' AFTER `incrtime`;
ALTER TABLE `npc_vendor_template`
	ADD COLUMN `itemflags` INT(10) UNSIGNED NOT NULL DEFAULT '0' AFTER `incrtime`;
	
UPDATE `npc_vendor` SET `itemflags`='3' WHERE maxcount > 0 and item in (3735,4355,5489,5640,5642,5643,5771,5772,5786,5787,5788,5789,5973,6047,6053,6054,6055,6056,6057,6068,6270,6272,6274,6275,6342,6346,6349,6377,6401,
6474,6475,7088,7089,7114,7290,7362,7451,7560,7561,7613,7742,8385,8409,9300,9301,9302,9305,10311,10314,10317,10321,10323,10325,10326,10602,10607,10609,10728,10858,11039,11101,11163,11223,12162,12163,12164,12228,12231,
12232,12240,13287,13288,13309,13310,13311,13477,13478,13480,14468,14469,14472,14481,14483,14488,14634,14635,14639,15724,15725,15726,15729,15734,15735,15740,15741,15751,15758,15759,15762,16046,16047,16050,16217,16221,
16224,16243,16767,17017,17018,17022,17023,17025,17049,17051,17059,17060,18239,18647,18648,18650,18651,18652,18656,18731,18949,19206,19219,19330,19444,19448,19449,20761);


-- End of migration.
END IF;
END??
delimiter ; 
CALL add_migration();
DROP PROCEDURE IF EXISTS add_migration;
